/**
 mithril-canvas - Mithril Canvas library
 @version v0.0.1
 @link https://github.com/7korobi/mithril-canvas
 @license 
**/
(function(){var t,n,o,e,u;o=function(t,n){var o,e,u,c,r,s;return e=t.pageX,u=t.pageY,o=n.left,c=n.top,r=2*(e-o-window.scrollX),s=2*(u-c-window.scrollY),{x:r,y:s}},e=function(t,n){var o,e,u,c,r,s;return e=t.pageX,u=t.pageY,o=n.left,c=n.top,r=2*(e-o),s=2*(u-c-window.scrollY),{x:r,y:s}},module.exports=function(u){return u.ios||u.ff||u.old&&u.chrome?n.touch=o:n.touch=e,t},n={touch:e,mouse:function(t){var n,o;return n=t.offsetX||t.layerX,o=t.offsetY||t.layerY,null!=n&&null!=o?(n*=2,o*=2,{x:n,y:o}):void 0},offsets:function(t,o,e){var u,c;if(e.offset=null,e.offsets=[],null!=t&&null!=o)if(null!=t.touches){if(u=o.getBoundingClientRect(),e.offsets=function(){var o,e,r,s;for(r=t.touches,s=[],o=0,e=r.length;e>o;o++)c=r[o],s.push(n.touch(c,u));return s}(),1===t.touches.length)return e.offset=e.offsets[0]}else if(e.offset=n.mouse(t),null!=e.offset)return e.offsets=[e.offset]},offset:function(t,o){var e;return null==t||null==o?null:null!=t.touches?(e=o.getBoundingClientRect(),n.touch(t.touches[0],e)):n.mouse(t)}},u=["config","data","background","draw","onmove"],t={controller:function(t,o,e){var c,r,s,f,a,l,i,h,v,d,g,m,p,w,x,y,Y,_;for(x=e.size,_=x[0],g=x[1],y=_+"x"+g,s=null,l=new o(e),m=0,p=u.length;p>m;m++)d=u[m],null==l[d]&&(l[d]=function(){});c={state:"boot",is_touch:!1,offsets:[],event:{}},f=function(t){return t.preventDefault(),c.event=t,l.onmove(c),h()},Y=function(t){return c.state="onstart",c.is_touch=!0,f(t)},r=function(t){return c.state="oncancel",c.is_touch=!1,f(t)},v=function(t){return c.state="onend",c.is_touch=!1,f(t)},w=function(t){return c.state="onmove",n.offsets(t,s,c),c.event=t,f(t)},i=function(){var t,n,o;return t=c.ctx,n=l.data(),n&&(null==n.canvas&&(n.canvas={}),o=n.canvas[y])?void t.putImageData(o,0,0):(l.background(c),n?n.canvas[y]=t.getImageData(0,0,2*_,2*g):void 0)},h=function(){return i(),l.draw(c)},a=function(t,n,o){return c.ctx||(s=t,c.ctx=s.getContext("2d")),l.config(s,n,o),l.onmove(c),h()},this.canvas_attr={width:_,height:g,style:"width: "+_/2+"px; height: "+g/2+"px;",ontouchend:v,ontouchmove:w,ontouchstart:Y,ontouchcancel:r,onmouseup:v,onmousemove:w,onmousedown:Y,onmouseout:v,onmouseover:w,config:a}},view:function(t,n){return m("canvas"+n,t.canvas_attr)}}}).call(this);